syntax = "proto3";

option csharp_namespace = "Raft";

message LeaderQueryRequest{
}

message LeaderQueryReply{
  string host = 1;
  int32 port = 2;
  string name = 3;
}

service LeaderDiscoverySvc {
  rpc GetLeader (LeaderQueryRequest) returns (LeaderQueryReply);
}

message PingRequest{
}

message PingReply{
  string reply = 1;
}

service PingSvc {
  rpc Ping (PingRequest) returns (PingReply);
}

message NodeInfoRequest{
}

message NodeInfoReply{
  string name = 1;
  string role = 2;
  string address = 3;
  string leaderAddress = 4;
  string knownNodes = 5;
  string commitIndex = 6;
  string term = 7;
}

service NodeInfoSvc{
  rpc GetInfo (NodeInfoRequest) returns (NodeInfoReply);
}

message CommandRequest{
  string variable = 1;
  string operation = 2;
  int32 literal = 3;
}

message CommandReply{
  string result = 1;
}

service CommandSvc{
  rpc ApplyCommand (CommandRequest) returns (CommandReply);
}

message LogEntryMessage {
  CommandRequest command = 1;
  int32 term = 2;
}

message AppendEntriesRequest{
  int32 term = 1;
  string leaderId = 2;
  int32 prevLogIndex = 3;
  int32 prevLogTerm = 4;
  repeated LogEntryMessage entries = 5;
  int32 leaderCommit = 6;
}

message AppendEntriesReply{
  int32 term = 1;
  bool success = 2;
}

service AppendEntriesSvc{
  rpc AppendEntries(AppendEntriesRequest) returns (AppendEntriesReply);
}

message RegisterNodeRequest {
  string name = 1;
  string host = 2;
  int32 port = 3;
}

message NodeInfoMessage {
  string name = 1;
  string host = 2;
  int32 port = 3;
}

message RegisterNodeRply {
  string reply = 1;
  repeated NodeInfoMessage nodes = 2;
}

service RegisterNodeSvc{
  rpc RegisterNode(RegisterNodeRequest) returns (RegisterNodeRply);
}

message LogInfoRequest{
}

message LogInfoReply{
  string entries = 1;
}

service LogInfoSvc{
  rpc GetLogLInfo(LogInfoRequest) returns (LogInfoReply);
}

message DisconnectMessage{
}

message DisconnectReply{
  string reply = 1;
}

message ReconnectMessage{
}

message ReconnectReply{
  string reply = 1;
}

service ControlSvc{
  rpc DisconnectNode(DisconnectMessage) returns  (DisconnectReply);
  rpc ReconnectNode(ReconnectMessage) returns (ReconnectReply);
}

message GetStateMassage {
}

message GetStateReply {
  string value = 1;
  repeated string errors = 2;
}

service GetStateSvc {
  rpc GetState(GetStateMassage) returns (GetStateReply);
}

message RequestForVoteMessage{
  int32 term = 1;
  string candidateId = 2; 
}

message RequestForVoteReply {
  int32 term = 1;
  bool voteGranted = 2;
}

service RequestForVoteSvc {
  rpc RequestVote(RequestForVoteMessage) returns (RequestForVoteReply);
}